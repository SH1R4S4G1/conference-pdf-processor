(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{8312:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return n(569)}])},569:function(e,t,n){"use strict";function r(e,t,n,r,o,a,i){try{var c=e[a](i),s=c.value}catch(l){return void n(l)}c.done?t(s):Promise.resolve(s).then(r,o)}function o(e){return function(){var t=this,n=arguments;return new Promise((function(o,a){var i=e.apply(t,n);function c(e){r(i,o,a,c,s,"next",e)}function s(e){r(i,o,a,c,s,"throw",e)}c(void 0)}))}}function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){a(e,t,n[t])}))}return e}function c(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function l(e){return function(e){if(Array.isArray(e))return s(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"===typeof e)return s(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}n.r(t),n.d(t,{default:function(){return p}});var u=n(7582),f=n(5893),d=n(7294),h=n(1864);function p(){var e=(0,d.useState)(null),t=(e[0],e[1],(0,d.useState)(null)),n=(t[0],t[1],(0,d.useState)([])),r=n[0],a=n[1],s=(0,d.useState)([]),p=s[0],g=s[1],v=(0,d.useState)(!1),b=v[0],y=(v[1],(0,d.useState)([])),w=y[0],m=(y[1],(0,d.useState)([])),x=(m[0],m[1],(0,d.useState)([])),j=x[0],k=x[1];(0,d.useEffect)((function(){console.log("fileList has changed:",r)}),[r]),(0,d.useEffect)((function(){console.log("oddPageFiles has changed:",p)}),[p]);var O=function(){var e=o((function(){var e;return(0,u.__generator)(this,(function(t){switch(t.label){case 0:return[4,window.electron.invoke("get-temp-files")];case 1:return e=t.sent(),a(e),[2]}}))}));return function(){return e.apply(this,arguments)}}();(0,d.useEffect)((function(){O()}),[]),(0,d.useEffect)((function(){r.length>0&&0===j.length&&C()}),[r]);var P=function(){var e=o((function(e){var t,n,r;return(0,u.__generator)(this,(function(o){switch(o.label){case 0:t=function(e){var t,r,o,a,i,c,s,f;return(0,u.__generator)(this,(function(u){switch(u.label){case 0:return r=n[e],o=null===(t=r.name.split(".").pop())||void 0===t?void 0:t.toLowerCase(),"application/pdf"===r.type||["doc","docx","xls","xlsx","ppt","pptx"].includes(o||"")?[4,r.arrayBuffer()]:[3,12];case 1:return a=u.sent(),[4,window.electron.invoke("get-os-tmpdir")];case 2:return i=u.sent(),console.log("Temp Directory:",i),c=Date.now()+".pdf",s=h.join(i,c).replace(/\//g,"\\"),h.basename(s),console.log(o,r.type,r.path,s),["doc","docx"].includes(o||"")?(console.log(s),[4,window.electron.invoke("convert-word-to-pdf",r.path,s)]):[3,4];case 3:return u.sent(),[3,10];case 4:return["xls","xlsx"].includes(o||"")?[4,window.electron.invoke("convert-excel-to-pdf",r.path,s)]:[3,6];case 5:return u.sent(),[3,10];case 6:return["ppt","pptx"].includes(o||"")?[4,window.electron.invoke("convert-ppt-to-pdf",r.path,s)]:[3,8];case 7:return u.sent(),[3,10];case 8:return"application/pdf"!==r.type?[3,10]:[4,window.electron.invoke("save-to-temp",new Uint8Array(a),s)];case 9:u.sent(),u.label=10;case 10:return[4,window.electron.invoke("get-pdf-page-count",s)];case 11:return f=u.sent(),console.log(f),f%2!==0&&(console.log("\u30da\u30fc\u30b8\u6570\u304c\u5947\u6570\u3067\u3059\u3002"),g((function(e){return l(e).concat([s])}))),[3,13];case 12:alert("".concat(r.name," is not a supported file type.")),u.label=13;case 13:return[2]}}))},e.preventDefault(),n=e.dataTransfer.files,r=0,o.label=1;case 1:return r<n.length?[5,(0,u.__values)(t(r))]:[3,4];case 2:o.sent(),o.label=3;case 3:return r++,[3,1];case 4:return O(),[2]}}))}));return function(t){return e.apply(this,arguments)}}(),_=(function(){var e=o((function(){var e,t,n,r,o,i,c;return(0,u.__generator)(this,(function(s){switch(s.label){case 0:e=!0,t=!1,n=void 0,s.label=1;case 1:s.trys.push([1,6,7,8]),r=function(){var e,t,n;return(0,u.__generator)(this,(function(r){switch(r.label){case 0:e=i.value,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,window.electron.invoke("add-blank-page",e)];case 2:return t=r.sent(),a((function(e){return l(e).concat([t])})),[3,4];case 3:return n=r.sent(),console.error("Error adding blank page to ".concat(e,":"),n),[3,4];case 4:return[2]}}))},o=w[Symbol.iterator](),s.label=2;case 2:return(e=(i=o.next()).done)?[3,5]:[5,(0,u.__values)(r())];case 3:s.sent(),s.label=4;case 4:return e=!0,[3,2];case 5:return[3,8];case 6:return c=s.sent(),t=!0,n=c,[3,8];case 7:try{e||null==o.return||o.return()}finally{if(t)throw n}return[7];case 8:return console.log("\u767d\u7d19\u5dee\u3057\u8fbc\u307f\u5b8c\u4e86"),O(),[2]}}))}))}(),function(){var e=o((function(){var e,t;return(0,u.__generator)(this,(function(n){switch(n.label){case 0:console.log(r),n.label=1;case 1:return n.trys.push([1,4,,5]),[4,window.electron.invoke("combine-pdfs",{files:r,addPageNumbers:b})];case 2:return e=n.sent(),[4,window.electron.invoke("open-file",e)];case 3:return n.sent(),[3,5];case 4:return t=n.sent(),console.error("Error combining PDFs:",t),[3,5];case 5:return[2]}}))}))}(),function(){var e=o((function(){var e,t,n,r,o,a,i,c,s;return(0,u.__generator)(this,(function(l){switch(l.label){case 0:e=!0,t=!1,n=void 0,l.label=1;case 1:l.trys.push([1,8,9,10]),r=j[Symbol.iterator](),l.label=2;case 2:return(e=(o=r.next()).done)?[3,7]:(a=o.value,[4,A(a)]);case 3:return i=l.sent(),[4,window.electron.invoke("combine-pdfs",{files:i,addPageNumbers:a.addPageNumbers})];case 4:return c=l.sent(),[4,window.electron.invoke("open-file",c)];case 5:l.sent(),l.label=6;case 6:return e=!0,[3,2];case 7:return[3,10];case 8:return s=l.sent(),t=!0,n=s,[3,10];case 9:try{e||null==r.return||r.return()}finally{if(t)throw n}return[7];case 10:return[2]}}))}));return function(){return e.apply(this,arguments)}}()),A=function(){var e=o((function(e){var t,n,o,a,i,c,s,l,f;return(0,u.__generator)(this,(function(u){switch(u.label){case 0:t=[],n=!0,o=!1,a=void 0,u.label=1;case 1:u.trys.push([1,7,8,9]),i=r[Symbol.iterator](),u.label=2;case 2:return(n=(c=i.next()).done)?[3,6]:(s=c.value,e.oddPageFiles.includes(s)?[4,window.electron.invoke("add-blank-page",s)]:[3,4]);case 3:return l=u.sent(),t.push(l),[3,5];case 4:t.push(s),u.label=5;case 5:return n=!0,[3,2];case 6:return[3,9];case 7:return f=u.sent(),o=!0,a=f,[3,9];case 8:try{n||null==i.return||i.return()}finally{if(o)throw a}return[7];case 9:return[2,t]}}))}));return function(t){return e.apply(this,arguments)}}(),C=function(){var e={id:Date.now(),addPageNumbers:!1,oddPageFiles:[]};k((function(t){return l(t).concat([e])}))};return(0,f.jsxs)("div",{children:[(0,f.jsx)("div",{onDrop:P,onDragOver:function(e){return e.preventDefault()},style:{border:"1px dashed",height:"200px"},children:"PDF\u3092\u3053\u3053\u306b\u30c9\u30ed\u30c3\u30d7"}),(0,f.jsxs)("div",{children:[(0,f.jsx)("h2",{children:"\u51e6\u7406\u524d\u306e\u30d5\u30a1\u30a4\u30eb\u30ea\u30b9\u30c8"}),(0,f.jsxs)("table",{children:[(0,f.jsx)("thead",{children:(0,f.jsxs)("tr",{children:[(0,f.jsx)("th",{children:"\u30d5\u30a1\u30a4\u30eb\u540d"}),j.map((function(e){return(0,f.jsxs)("th",{children:["\u30d1\u30bf\u30fc\u30f3 ",e.id,(0,f.jsx)("br",{}),(0,f.jsxs)("label",{children:[(0,f.jsx)("input",{type:"checkbox",checked:e.addPageNumbers,onChange:function(t){var n=j.map((function(n){return n.id===e.id?c(i({},n),{addPageNumbers:t.target.checked}):n}));k(n)}}),"\u30da\u30fc\u30b8\u6570\u3092\u4ed8\u4e0e"]})]},e.id)}))]})}),(0,f.jsx)("tbody",{children:r.map((function(e){return(0,f.jsxs)("tr",{children:[(0,f.jsx)("td",{children:h.basename(e)}),j.map((function(t){return(0,f.jsx)("td",{children:p.includes(e)&&(0,f.jsx)("input",{type:"checkbox",checked:t.oddPageFiles.includes(e),onChange:function(n){var r=j.map((function(r){return r.id===t.id?n.target.checked?c(i({},r),{oddPageFiles:l(r.oddPageFiles).concat([e])}):c(i({},r),{oddPageFiles:r.oddPageFiles.filter((function(t){return t!==e}))}):r}));k(r)}})},t.id)}))]},e)}))})]}),r.length>0&&(0,f.jsx)("button",{onClick:C,children:"\uff0b"}),j.length>0&&(0,f.jsx)("button",{onClick:_,children:"\u30d5\u30a1\u30a4\u30eb\u3092\u7d71\u5408\u3059\u308b"})]})]})}},1864:function(e){!function(){"use strict";var t={114:function(e){function t(e){if("string"!==typeof e)throw new TypeError("Path must be a string. Received "+JSON.stringify(e))}function n(e,t){for(var n,r="",o=0,a=-1,i=0,c=0;c<=e.length;++c){if(c<e.length)n=e.charCodeAt(c);else{if(47===n)break;n=47}if(47===n){if(a===c-1||1===i);else if(a!==c-1&&2===i){if(r.length<2||2!==o||46!==r.charCodeAt(r.length-1)||46!==r.charCodeAt(r.length-2))if(r.length>2){var s=r.lastIndexOf("/");if(s!==r.length-1){-1===s?(r="",o=0):o=(r=r.slice(0,s)).length-1-r.lastIndexOf("/"),a=c,i=0;continue}}else if(2===r.length||1===r.length){r="",o=0,a=c,i=0;continue}t&&(r.length>0?r+="/..":r="..",o=2)}else r.length>0?r+="/"+e.slice(a+1,c):r=e.slice(a+1,c),o=c-a-1;a=c,i=0}else 46===n&&-1!==i?++i:i=-1}return r}var r={resolve:function(){for(var e,r="",o=!1,a=arguments.length-1;a>=-1&&!o;a--){var i;a>=0?i=arguments[a]:(void 0===e&&(e=""),i=e),t(i),0!==i.length&&(r=i+"/"+r,o=47===i.charCodeAt(0))}return r=n(r,!o),o?r.length>0?"/"+r:"/":r.length>0?r:"."},normalize:function(e){if(t(e),0===e.length)return".";var r=47===e.charCodeAt(0),o=47===e.charCodeAt(e.length-1);return 0!==(e=n(e,!r)).length||r||(e="."),e.length>0&&o&&(e+="/"),r?"/"+e:e},isAbsolute:function(e){return t(e),e.length>0&&47===e.charCodeAt(0)},join:function(){if(0===arguments.length)return".";for(var e,n=0;n<arguments.length;++n){var o=arguments[n];t(o),o.length>0&&(void 0===e?e=o:e+="/"+o)}return void 0===e?".":r.normalize(e)},relative:function(e,n){if(t(e),t(n),e===n)return"";if((e=r.resolve(e))===(n=r.resolve(n)))return"";for(var o=1;o<e.length&&47===e.charCodeAt(o);++o);for(var a=e.length,i=a-o,c=1;c<n.length&&47===n.charCodeAt(c);++c);for(var s=n.length-c,l=i<s?i:s,u=-1,f=0;f<=l;++f){if(f===l){if(s>l){if(47===n.charCodeAt(c+f))return n.slice(c+f+1);if(0===f)return n.slice(c+f)}else i>l&&(47===e.charCodeAt(o+f)?u=f:0===f&&(u=0));break}var d=e.charCodeAt(o+f);if(d!==n.charCodeAt(c+f))break;47===d&&(u=f)}var h="";for(f=o+u+1;f<=a;++f)f!==a&&47!==e.charCodeAt(f)||(0===h.length?h+="..":h+="/..");return h.length>0?h+n.slice(c+u):(c+=u,47===n.charCodeAt(c)&&++c,n.slice(c))},_makeLong:function(e){return e},dirname:function(e){if(t(e),0===e.length)return".";for(var n=e.charCodeAt(0),r=47===n,o=-1,a=!0,i=e.length-1;i>=1;--i)if(47===(n=e.charCodeAt(i))){if(!a){o=i;break}}else a=!1;return-1===o?r?"/":".":r&&1===o?"//":e.slice(0,o)},basename:function(e,n){if(void 0!==n&&"string"!==typeof n)throw new TypeError('"ext" argument must be a string');t(e);var r,o=0,a=-1,i=!0;if(void 0!==n&&n.length>0&&n.length<=e.length){if(n.length===e.length&&n===e)return"";var c=n.length-1,s=-1;for(r=e.length-1;r>=0;--r){var l=e.charCodeAt(r);if(47===l){if(!i){o=r+1;break}}else-1===s&&(i=!1,s=r+1),c>=0&&(l===n.charCodeAt(c)?-1===--c&&(a=r):(c=-1,a=s))}return o===a?a=s:-1===a&&(a=e.length),e.slice(o,a)}for(r=e.length-1;r>=0;--r)if(47===e.charCodeAt(r)){if(!i){o=r+1;break}}else-1===a&&(i=!1,a=r+1);return-1===a?"":e.slice(o,a)},extname:function(e){t(e);for(var n=-1,r=0,o=-1,a=!0,i=0,c=e.length-1;c>=0;--c){var s=e.charCodeAt(c);if(47!==s)-1===o&&(a=!1,o=c+1),46===s?-1===n?n=c:1!==i&&(i=1):-1!==n&&(i=-1);else if(!a){r=c+1;break}}return-1===n||-1===o||0===i||1===i&&n===o-1&&n===r+1?"":e.slice(n,o)},format:function(e){if(null===e||"object"!==typeof e)throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof e);return function(e,t){var n=t.dir||t.root,r=t.base||(t.name||"")+(t.ext||"");return n?n===t.root?n+r:n+e+r:r}("/",e)},parse:function(e){t(e);var n={root:"",dir:"",base:"",ext:"",name:""};if(0===e.length)return n;var r,o=e.charCodeAt(0),a=47===o;a?(n.root="/",r=1):r=0;for(var i=-1,c=0,s=-1,l=!0,u=e.length-1,f=0;u>=r;--u)if(47!==(o=e.charCodeAt(u)))-1===s&&(l=!1,s=u+1),46===o?-1===i?i=u:1!==f&&(f=1):-1!==i&&(f=-1);else if(!l){c=u+1;break}return-1===i||-1===s||0===f||1===f&&i===s-1&&i===c+1?-1!==s&&(n.base=n.name=0===c&&a?e.slice(1,s):e.slice(c,s)):(0===c&&a?(n.name=e.slice(1,i),n.base=e.slice(1,s)):(n.name=e.slice(c,i),n.base=e.slice(c,s)),n.ext=e.slice(i,s)),c>0?n.dir=e.slice(0,c-1):a&&(n.dir="/"),n},sep:"/",delimiter:":",win32:null,posix:null};r.posix=r,e.exports=r}},n={};function r(e){var o=n[e];if(void 0!==o)return o.exports;var a=n[e]={exports:{}},i=!0;try{t[e](a,a.exports,r),i=!1}finally{i&&delete n[e]}return a.exports}r.ab="//";var o=r(114);e.exports=o}()}},function(e){e.O(0,[774,888,179],(function(){return t=8312,e(e.s=t);var t}));var t=e.O();_N_E=t}]);