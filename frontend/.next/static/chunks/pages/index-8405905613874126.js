(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{8312:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return t(2884)}])},2884:function(e,n,t){"use strict";function r(e,n,t,r,o,i,a){try{var c=e[i](a),u=c.value}catch(l){return void t(l)}c.done?n(u):Promise.resolve(u).then(r,o)}function o(e){return function(){var n=this,t=arguments;return new Promise((function(o,i){var a=e.apply(n,t);function c(e){r(a,o,i,c,u,"next",e)}function u(e){r(a,o,i,c,u,"throw",e)}c(void 0)}))}}t.r(n),t.d(n,{default:function(){return s}});var i=t(7582),a=t(5893),c=t(7294),u=t(3461),l=t(1864);function s(){var e=(0,c.useState)(null),n=e[0],t=(e[1],(0,c.useState)(null)),r=t[0],s=(t[1],(0,c.useState)([])),f=s[0],h=s[1],d=function(){var e=o((function(){var e;return(0,i.__generator)(this,(function(n){switch(n.label){case 0:return[4,window.electron.invoke("get-temp-files")];case 1:return e=n.sent(),h(e),[2]}}))}));return function(){return e.apply(this,arguments)}}();(0,c.useEffect)((function(){d()}),[]);var p=function(){var e=o((function(e){var n,t,r,o,a,c,s,f,h,p;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:e.preventDefault(),n=e.dataTransfer.files,t=0,i.label=1;case 1:return t<n.length?(o=n[t],a=null===(r=o.name.split(".").pop())||void 0===r?void 0:r.toLowerCase(),c=null,"application/pdf"===o.type||["doc","docx","xls","xlsx","ppt","pptx"].includes(a||"")?[4,o.arrayBuffer()]:[3,11]):[3,13];case 2:return s=i.sent(),f=u.tmpdir(),h=Date.now()+".pdf",p=l.join(f,h),console.log(a,o.type,o.path,p),["doc","docx"].includes(a||"")?[4,window.electron.invoke("convert-word-to-pdf",o.path,p)]:[3,4];case 3:return c=i.sent(),console.log(c),[3,10];case 4:return["xls","xlsx"].includes(a||"")?[4,window.electron.invoke("convert-excel-to-pdf",o.path,p)]:[3,6];case 5:return c=i.sent(),[3,10];case 6:return["ppt","pptx"].includes(a||"")?[4,window.electron.invoke("convert-ppt-to-pdf",o.path,p)]:[3,8];case 7:return c=i.sent(),[3,10];case 8:return"application/pdf"!==o.type?[3,10]:[4,window.electron.invoke("save-to-temp",new Uint8Array(s))];case 9:i.sent(),i.label=10;case 10:return[3,12];case 11:alert("".concat(o.name," is not a supported file type.")),i.label=12;case 12:return t++,[3,1];case 13:return d(),[2]}}))}));return function(n){return e.apply(this,arguments)}}();return(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{onDrop:p,onDragOver:function(e){return e.preventDefault()},style:{border:"1px dashed",height:"200px"},children:"PDF\u3092\u3053\u3053\u306b\u30c9\u30ed\u30c3\u30d7"}),r&&(0,a.jsxs)("div",{children:[(0,a.jsx)("img",{src:r,alt:"\u30b5\u30e0\u30cd\u30a4\u30eb"}),(0,a.jsx)("a",{href:n?URL.createObjectURL(n):"#",download:"edited.pdf",children:"\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{children:"Uploaded Files"}),(0,a.jsx)("ul",{children:f.map((function(e){return(0,a.jsx)("li",{children:e},e)}))})]})]})}},3461:function(e){!function(){"undefined"!==typeof __nccwpck_require__&&(__nccwpck_require__.ab="//");var n={};!function(){var e=n;e.endianness=function(){return"LE"},e.hostname=function(){return"undefined"!==typeof location?location.hostname:""},e.loadavg=function(){return[]},e.uptime=function(){return 0},e.freemem=function(){return Number.MAX_VALUE},e.totalmem=function(){return Number.MAX_VALUE},e.cpus=function(){return[]},e.type=function(){return"Browser"},e.release=function(){return"undefined"!==typeof navigator?navigator.appVersion:""},e.networkInterfaces=e.getNetworkInterfaces=function(){return{}},e.arch=function(){return"javascript"},e.platform=function(){return"browser"},e.tmpdir=e.tmpDir=function(){return"/tmp"},e.EOL="\n",e.homedir=function(){return"/"}}(),e.exports=n}()},1864:function(e){!function(){"use strict";var n={114:function(e){function n(e){if("string"!==typeof e)throw new TypeError("Path must be a string. Received "+JSON.stringify(e))}function t(e,n){for(var t,r="",o=0,i=-1,a=0,c=0;c<=e.length;++c){if(c<e.length)t=e.charCodeAt(c);else{if(47===t)break;t=47}if(47===t){if(i===c-1||1===a);else if(i!==c-1&&2===a){if(r.length<2||2!==o||46!==r.charCodeAt(r.length-1)||46!==r.charCodeAt(r.length-2))if(r.length>2){var u=r.lastIndexOf("/");if(u!==r.length-1){-1===u?(r="",o=0):o=(r=r.slice(0,u)).length-1-r.lastIndexOf("/"),i=c,a=0;continue}}else if(2===r.length||1===r.length){r="",o=0,i=c,a=0;continue}n&&(r.length>0?r+="/..":r="..",o=2)}else r.length>0?r+="/"+e.slice(i+1,c):r=e.slice(i+1,c),o=c-i-1;i=c,a=0}else 46===t&&-1!==a?++a:a=-1}return r}var r={resolve:function(){for(var e,r="",o=!1,i=arguments.length-1;i>=-1&&!o;i--){var a;i>=0?a=arguments[i]:(void 0===e&&(e=""),a=e),n(a),0!==a.length&&(r=a+"/"+r,o=47===a.charCodeAt(0))}return r=t(r,!o),o?r.length>0?"/"+r:"/":r.length>0?r:"."},normalize:function(e){if(n(e),0===e.length)return".";var r=47===e.charCodeAt(0),o=47===e.charCodeAt(e.length-1);return 0!==(e=t(e,!r)).length||r||(e="."),e.length>0&&o&&(e+="/"),r?"/"+e:e},isAbsolute:function(e){return n(e),e.length>0&&47===e.charCodeAt(0)},join:function(){if(0===arguments.length)return".";for(var e,t=0;t<arguments.length;++t){var o=arguments[t];n(o),o.length>0&&(void 0===e?e=o:e+="/"+o)}return void 0===e?".":r.normalize(e)},relative:function(e,t){if(n(e),n(t),e===t)return"";if((e=r.resolve(e))===(t=r.resolve(t)))return"";for(var o=1;o<e.length&&47===e.charCodeAt(o);++o);for(var i=e.length,a=i-o,c=1;c<t.length&&47===t.charCodeAt(c);++c);for(var u=t.length-c,l=a<u?a:u,s=-1,f=0;f<=l;++f){if(f===l){if(u>l){if(47===t.charCodeAt(c+f))return t.slice(c+f+1);if(0===f)return t.slice(c+f)}else a>l&&(47===e.charCodeAt(o+f)?s=f:0===f&&(s=0));break}var h=e.charCodeAt(o+f);if(h!==t.charCodeAt(c+f))break;47===h&&(s=f)}var d="";for(f=o+s+1;f<=i;++f)f!==i&&47!==e.charCodeAt(f)||(0===d.length?d+="..":d+="/..");return d.length>0?d+t.slice(c+s):(c+=s,47===t.charCodeAt(c)&&++c,t.slice(c))},_makeLong:function(e){return e},dirname:function(e){if(n(e),0===e.length)return".";for(var t=e.charCodeAt(0),r=47===t,o=-1,i=!0,a=e.length-1;a>=1;--a)if(47===(t=e.charCodeAt(a))){if(!i){o=a;break}}else i=!1;return-1===o?r?"/":".":r&&1===o?"//":e.slice(0,o)},basename:function(e,t){if(void 0!==t&&"string"!==typeof t)throw new TypeError('"ext" argument must be a string');n(e);var r,o=0,i=-1,a=!0;if(void 0!==t&&t.length>0&&t.length<=e.length){if(t.length===e.length&&t===e)return"";var c=t.length-1,u=-1;for(r=e.length-1;r>=0;--r){var l=e.charCodeAt(r);if(47===l){if(!a){o=r+1;break}}else-1===u&&(a=!1,u=r+1),c>=0&&(l===t.charCodeAt(c)?-1===--c&&(i=r):(c=-1,i=u))}return o===i?i=u:-1===i&&(i=e.length),e.slice(o,i)}for(r=e.length-1;r>=0;--r)if(47===e.charCodeAt(r)){if(!a){o=r+1;break}}else-1===i&&(a=!1,i=r+1);return-1===i?"":e.slice(o,i)},extname:function(e){n(e);for(var t=-1,r=0,o=-1,i=!0,a=0,c=e.length-1;c>=0;--c){var u=e.charCodeAt(c);if(47!==u)-1===o&&(i=!1,o=c+1),46===u?-1===t?t=c:1!==a&&(a=1):-1!==t&&(a=-1);else if(!i){r=c+1;break}}return-1===t||-1===o||0===a||1===a&&t===o-1&&t===r+1?"":e.slice(t,o)},format:function(e){if(null===e||"object"!==typeof e)throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof e);return function(e,n){var t=n.dir||n.root,r=n.base||(n.name||"")+(n.ext||"");return t?t===n.root?t+r:t+e+r:r}("/",e)},parse:function(e){n(e);var t={root:"",dir:"",base:"",ext:"",name:""};if(0===e.length)return t;var r,o=e.charCodeAt(0),i=47===o;i?(t.root="/",r=1):r=0;for(var a=-1,c=0,u=-1,l=!0,s=e.length-1,f=0;s>=r;--s)if(47!==(o=e.charCodeAt(s)))-1===u&&(l=!1,u=s+1),46===o?-1===a?a=s:1!==f&&(f=1):-1!==a&&(f=-1);else if(!l){c=s+1;break}return-1===a||-1===u||0===f||1===f&&a===u-1&&a===c+1?-1!==u&&(t.base=t.name=0===c&&i?e.slice(1,u):e.slice(c,u)):(0===c&&i?(t.name=e.slice(1,a),t.base=e.slice(1,u)):(t.name=e.slice(c,a),t.base=e.slice(c,u)),t.ext=e.slice(a,u)),c>0?t.dir=e.slice(0,c-1):i&&(t.dir="/"),t},sep:"/",delimiter:":",win32:null,posix:null};r.posix=r,e.exports=r}},t={};function r(e){var o=t[e];if(void 0!==o)return o.exports;var i=t[e]={exports:{}},a=!0;try{n[e](i,i.exports,r),a=!1}finally{a&&delete t[e]}return i.exports}r.ab="//";var o=r(114);e.exports=o}()}},function(e){e.O(0,[774,888,179],(function(){return n=8312,e(e.s=n);var n}));var n=e.O();_N_E=n}]);